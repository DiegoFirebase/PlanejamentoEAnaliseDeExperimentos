---
title: "Estudo de Caso 02: Avaliação e comparação do retorno médio de ações"
author: "Diego Pontes, Elias Vieira, Matheus Bitarães"
date: "Fevereiro, 2021"
output:
    pdf_document:
    fig_caption: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}

# Importação das bibliotecas (descomentar caso não tenha instalado)
# install.packages("ggplot2")

# Importação de bibliotecas
library(ggplot2)
library(dplyr)

```

## Descrição do problema


## Introdução


## Design do Experimento

Os dados de entrada do experimento são as informações de preços de fechamento mensais de 5 ações diferentes, onde cada coluna representa uma ação e cada linha representa um mes de fechamento. 
O que se deseja é comparar o potencial de cada ação em gerar maior ganho mensal ao investidor. Como modelos regressivos de previsão não são o escopo deste trabalho, pode-se realizar uma transformação nestes dados, de forma que haja um vetor com as flutuações percentuais das ações em cada mês. Por exemplo, se houver uma ação com preços de fechamento $[10, 11, 12, 10]$, pode-se gerar o seguinte vetor de flutuações percentuais: $[10\%, 9\%, -16\%]$.

Desta forma, é possivel realizar uma análise estatistica entre as 5 ações e identificar a que apresenta maior incidencia de flutuação positiva, o que será considerado como a ação de maior potencial para gerar retornos.

## Análise Estatística


### Importação dos dados

Os dados das ações foram importados do arquivo *DadosAcoesGrupoC.csv*. 

```{r, include=TRUE, echo=TRUE}

# importação dos dados
data <- read.csv(file = 'DadosAcoesGrupoC.csv', header = FALSE)
data <- data %>% 
dplyr::mutate(numeracao = 0:-(nrow(data)-1))
colnames(data) <- c("A1","A2","A3","A4","A5", "MES") # Adicionando nomes às colunas

# plot dos primeiros 6 dados da tabela
head(data)
```

Cada coluna representa uma ação e cada linha representa o preço de fechamento das ações no mes anterior. Portanto, a linha 1 indica o preço de fechamento do mes atual - 1, a linha 2 representa o mes atual - 2, e assim sucessivamente.

```{r, include=TRUE, echo=TRUE}
theme_set(theme_minimal())

# Plot
plot_a1 <- ggplot(data=data, aes(x=MES, y=A1)) + geom_line() + 
  labs(title = "Progressão da Ação 1", x = "Tempo (meses)", y = "Preço de fechamento das ações")
plot_a2 <- ggplot(data=data, aes(x=MES, y=A2)) + geom_line() + 
  labs(title = "Progressão da Ação 2", x = "Tempo (meses)", y = "Preço de fechamento das ações")
plot_a3 <- ggplot(data=data, aes(x=MES, y=A3)) + geom_line() + 
  labs(title = "Progressão da Ação 3", x = "Tempo (meses)", y = "Preço de fechamento das ações")
plot_a4 <- ggplot(data=data, aes(x=MES, y=A4)) + geom_line() + 
  labs(title = "Progressão da Ação 4", x = "Tempo (meses)", y = "Preço de fechamento das ações")
plot_a5 <- ggplot(data=data, aes(x=MES, y=A5)) + geom_line() + 
  labs(title = "Progressão da Ação 5", x = "Tempo (meses)", y = "Preço de fechamento das ações")

plot_a1
plot_a2
plot_a3
plot_a4
plot_a5
```

### Tratamento  dos dados

Os dados brutos serão transformados em flutuações percentuais para que se possa realizar a análise estatística.
```{r, include=TRUE, echo=TRUE}

# Transforma dados em porcentagens
data_perc <- data
for(i in 1:(nrow(data)-1)){
        data_perc[i,] <- 100*( (data[i,] - data[i+1,])/data[i+1,] ) # porcentagem de mudança do fechamento do mes i + 1 em relação ao mes i.
}

data_perc <- data_perc[-c(36), ] # removendo ultima linha

# Criando uma variável para cada amostra
data_a1 <- data_perc$A1
data_a2 <- data_perc$A2
data_a3 <- data_perc$A3
data_a4 <- data_perc$A4
data_a5 <- data_perc$A5
head(data_perc)
```

```{r, include=TRUE}
library(car)
#apply(data_perc, 2, leveneTest)

apply(data_perc, 2, shapiro.test)
#model <- aov(data = data_perc)
```

**algum comentario aqui**

```{r, include=TRUE}
# boxplot
boxplot(data_a1, data_a2, data_a3, data_a4, data_a5,
main = "Boxplots das flutuações percentuais",
at = c(1,2,3,4,5),
names = c("Ação 1", "Ação 2", "Ação 3", "Ação 4", "Ação 5"),
las = 2,
horizontal = TRUE,
notch = FALSE
)
```
**algum comentario sobre o boxplot**

### Dados estatísticos

**comparação entre as ações aqui**

## Discussão e Conclusão


### Atividades dos membros

**Diego**


**Elias**


**Matheus**


**Todos**

Elaboração das hipóteses e definição das premissas.


\renewcommand\refname{Referências Bibliográficas}
\bibliographystyle{unsrt}
\bibliography{referencias}
